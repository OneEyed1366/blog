<!doctype html><html lang=ru><head><title>Пару слов про тесты ::</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Немного мыслей по поводу тестов и всего, что с ними связано"><meta name=keywords content="программирование,блоги"><meta name=robots content="noodp"><link rel=canonical href=https://oneeyed1366.github.io/blog/posts/2022-10-07-thoughts-about-tests/><link rel=stylesheet href=https://oneeyed1366.github.io/blog/assets/style.css><link rel=stylesheet href=https://oneeyed1366.github.io/blog/assets/blue.css><link rel=apple-touch-icon href=https://oneeyed1366.github.io/blog/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://oneeyed1366.github.io/blog/img/favicon/blue.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="ru"><meta property="og:type" content="article"><meta property="og:title" content="Пару слов про тесты"><meta property="og:description" content="Немного мыслей по поводу тестов и всего, что с ними связано"><meta property="og:url" content="https://oneeyed1366.github.io/blog/posts/2022-10-07-thoughts-about-tests/"><meta property="og:site_name" content><meta property="og:image" content="https://oneeyed1366.github.io/blog/img/favicon/blue.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-10-07 18:05:41 +0300 +0300"></head><body class=blue><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=https://oneeyed1366.github.io/blog/posts><div class=logo>pseudo:Blog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://oneeyed1366.github.io/blog/about/blog>О блоге</a></li><li><a href=https://oneeyed1366.github.io/blog/about/me>Обо мне</a></li><ul class=menu__sub-inner><li class=menu__sub-inner-more-trigger>Раскрыть меню ▾</li><ul class="menu__sub-inner-more hidden"><li><a href=https://oneeyed1366.github.io/blog/tags>Список тегов</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://oneeyed1366.github.io/blog/about/blog>О блоге</a></li><li><a href=https://oneeyed1366.github.io/blog/about/me>Обо мне</a></li><li><a href=https://oneeyed1366.github.io/blog/tags>Список тегов</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://oneeyed1366.github.io/blog/posts/2022-10-07-thoughts-about-tests/>Пару слов про тесты</a></h1><div class=post-meta><span class=post-date>2022-10-07</span>
<span class=post-reading-time>:: ~7 минут чтения (1395 слов)</span></div><span class=post-tags>#<a href=https://oneeyed1366.github.io/blog/tags/frontend/>frontend</a>&nbsp;
#<a href=https://oneeyed1366.github.io/blog/tags/qa/>qa</a>&nbsp;
#<a href=https://oneeyed1366.github.io/blog/tags/javascript/>JavaScript</a>&nbsp;</span>
<img src=/blog/posts/2022-10-07-thoughts-about-tests/cover.jpeg class=post-cover alt="Пару слов про тесты" title="Cover Image"><div class=table-of-contents><h2>Оглавление</h2><nav id=TableOfContents><ul><li><a href=#тесты-есть-а-если-найду>Тесты есть? А если найду??</a><ul><li><a href=#список-костылей-карл-кос-ты-лей-инструментов-навскидку>Список (<strong>Костылей, Карл. КОС-ТЫ-ЛЕЙ</strong>) инструментов, навскидку</a></li></ul></li><li><a href=#интересная-штучка-но-есть-ли-у-неё-практическое-применение>&ldquo;Интересная штучка, но есть-ли у неё практическое применение?&rdquo;</a><ul><li><a href=#почему-дорого>Почему дорого?</a></li></ul></li><li><a href=#но-ведь-на-дистанции-все-равно-ведь-дешевле-содержать-с-тестами-разве-нет>Но ведь на дистанции все-равно ведь дешевле содержать с тестами, разве нет?</a><ul><li><a href=#что-значит-уметь-писать-тесты>Что значит: уметь писать тесты?</a></li><li><a href=#что-значит-у-бизнеса-есть-на-это-деньги>Что значит: у бизнеса есть на это деньги?</a></li></ul></li><li><a href=#привычка>Привычка?</a><ul><li><a href=#а-потом---суп-с-котом-шта>А потом - суп с котом (ШТА???)</a></li></ul></li><li><a href=#а-что-в-итоге>А что в итоге?</a><ul><li><a href=#андрюха-все-ня-давай-по-новой>&ldquo;Андрюха, все ***ня. Давай по-новой&rdquo;</a></li><li><a href=#мягкая-сила-в-действии>&ldquo;Мягкая сила&rdquo; в действии</a></li></ul></li></ul></nav></div><div class=post-content><div><h2 id=тесты-есть-а-если-найду>Тесты есть? А если найду??<a href=#тесты-есть-а-если-найду class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Рано или поздно каждый разраб слышит фразу: &ldquo;Хороший код должен быть покрыт тестами&rdquo;.
И вроде бы все логично: чем сложнее приложение, тем сложнее контролировать все его нюансы и взаимосвязи.</p><p>Значит, нужно <code>научить</code> какого-то исполнителя в вакууме тестировать то, что ты (или не ты)
написал в своем СУПЕР-МЕГА-ПРИЛОЖЕНИИ-ЗА-ОВЕР-ДОХРЕНА-ДЕНЕГ-В-НАНОСЕКУНДУ!</p><p>Ниже бегло рассмотрим пару-тройку сходу пришедших на ум инструментов
(ибо разрабы, будучи людьми &ldquo;прогрессивными&rdquo; &mdash;читать <em>ЛЕНИВЫМИ</em>&mdash; уже придумали довольно
много инструментов, которые позволяют эту проблему решить.)</p><h3 id=список-костылей-карл-кос-ты-лей-инструментов-навскидку>Список (<strong>Костылей, Карл. КОС-ТЫ-ЛЕЙ</strong>) инструментов, навскидку<a href=#список-костылей-карл-кос-ты-лей-инструментов-навскидку class=hanchor arialabel=Anchor>&#8983;</a></h3><h4 id=jesthttpsjestjsio><a href=https://jestjs.io/>Jest</a><a href=#jesthttpsjestjsio class=hanchor arialabel=Anchor>&#8983;</a></h4><p>Являясь одним из самых популярных инструментов для тестирования, негласно считается
&ldquo;королем&rdquo; среди Enterprise-приложений (но это не точно)
Применяется как для <em>Unit</em>, так и для <em>Component</em> тестирования.
Можно применять и для <em>Integration</em> тестирования, но там уже немножко больно</p><p>(
Ловит въетнамские флэшбэки и вспоминает проекты, которые делали <em>E2E</em> тесты на Jest&rsquo;e&mldr;
<strong>Автор ушел пить кофе и рефлексировать, что раньше код был чище, а трава &ndash; зеленей</strong>
)</p><p>Плюсы:</p><ul><li>Легче интергрируется с <a href=https://testing-library.com/docs/react-testing-library/intro/>React-testing-library</a></li><li>Хорошая дока, которая позволит тебе в моменте посмотреть, где и что ты не туда запихал</li><li>Jest - лапочка, который легко и непринужденно вливается в любой проект (Не то, что я. <em>ПЛАЧЕТ</em>)</li><li>Довольно шустро крутит (твои планы на пятничный вечер) все, что ты в него запихаешь</li><li>Имеет богатую экосистему плагинов и расширений практически* под любой framework</li></ul><p>Минусы:</p><ul><li>&ldquo;Шаг влево\вправо - расстрел&rdquo;
(иногда банально настроить <em>pre-commit</em> - целый квест со случайно выпадающими гачи-микс сценами)</li><li>Е**нутая логика итерации по массиву</li><li>Залез в конфиги - пеняй на себя (особенно, если ты вообще не сечёшь, что и НАФИГА ты делаешь)</li></ul><h4 id=mochahttpsmochajsorg--chaihttpswwwchaijscom><a href=https://mochajs.org/>Mocha</a> + <a href=https://www.chaijs.com/>Chai</a><a href=#mochahttpsmochajsorg--chaihttpswwwchaijscom class=hanchor arialabel=Anchor>&#8983;</a></h4><p>&ldquo;Бонни и Клайд&rdquo; в мире тестирования Web SPA приложений.
Долго и упорно наступают на пятки &ldquo;мастодонту&rdquo; в лице Jest&rsquo;а.</p><p>Применяются также для <em>Unit</em>, <em>Component</em> & <em>Integration</em> тестирования.</p><p>Большой плюс: <em>Integration</em> тестирование легче масштабируется
(понятный большинству пример: сравните количество boilerplate&rsquo;а у ванильного
<a href=https://redux.js.org/><em>Redux</em></a>
&
<a href=https://mobx.js.org/><em>MobX</em></a></p><p>Плюсы:</p><ul><li>Вроде как легче интегрироваться с экосистемой Vue2
(за 3 версию не скажу, ибо щупал, но поверхностно)</li><li>Легче Jest&rsquo;а, и имеет чуть более читабельный синтаксис
(сугубо на вкус Автора)</li><li>На удивление шустрые ребята, которые могут сэкономить вам 2-3 секунды суровой
кодерской жизни (&ldquo;Плюсовики&rdquo; дружно одобряют)</li><li>Также богатая экосистема позволяет превратить эту почти невинную парочку
в адский комбайн, который будет тестировать всё, вся, и в первую очередь
нервы вашего ПМ&rsquo;а
(
когда его в 100500 раз вызовут на ковер с целью объяснить,
нахрена вы потратили 2 спринта &ldquo;на увеличение отказоустойчивости приложения&rdquo;,
если пришел очередной <code>chaotic-джун</code> и уронил production
)</li></ul><p>Минусы:</p><ul><li>Angular? Не, не слышал *^-^*</li><li>Подробная, но чутка переусложненная дока может вогнать в ступор,
а сразу после в неистовейшее ЖЕЛАНИЕ пойти поиграть с Jest&rsquo;ом</li><li>При обвешивании плагинами, становятся тяжелее Jest&rsquo;а</li><li>Mocha без Chai, что Нацу без Хэппи. Жить можно, но грустно.
(Да и, как-бы, НАФИГА?!)</li></ul><h4 id=cypresshttpsdocscypressioguidesoverviewwhy-cypresswhat-you-ll-learn><a href=https://docs.cypress.io/guides/overview/why-cypress#What-you-ll-learn>Cypress</a><a href=#cypresshttpsdocscypressioguidesoverviewwhy-cypresswhat-you-ll-learn class=hanchor arialabel=Anchor>&#8983;</a></h4><p>&ldquo;И вот, на 3 день!..&rdquo;
Ладно-ладно, интригу нагнал, теперь можно и пояснить.</p><p>Плюсы:</p><ul><li>Одно слово: ДОКА. Почитай, ты все поймешь</li><li>&ldquo;Клёвый, модный, молодежный&rdquo; инструмент, который хочет привнести в этот серый и скучный
мир QA немножко удобства и магии (&ldquo;Плюсовики&rdquo; дружно сделали страшную морду).</li><li>Почти безупречно подходит для большинства DEV QA сценариев
(у матерых QA&rsquo;щиков уже свой, потом и кровью выстраданный набор &ldquo;костылей&rdquo;),
часто используется для <em>Component</em>, <em>Integration</em> & <em>E2E</em> тестирования.</li><li>Из коробки (с какой-то бородатой версии) дает тебе красивый и, что важнее,
ТЫКАТЕЛЬНЫЙ UI, которым просто пользоваться.</li><li>Если ты (как и я) странный человек, который использует форки Chromium&rsquo;а,
то для таких &ldquo;одаренных&rdquo; тут также есть <code>Electron</code>, для прогона тестов внутри него.
У-Удобно</li></ul><p>Минусы:</p><ul><li>Тяжелый, перед первым запуском, по сути, требует установки отдельного Cypress приложения</li><li>Тяжело вливается в <em>Unit</em> тестирование (хотя может)</li><li>В зависимости от framework&rsquo;а, при <em>Component</em> тестироовании можно не раз (и нифига не два)
стабильно стрелять себе в колено. Не из дробовика, но все же</li><li>Имеет свой, &ldquo;Chai-подобный&rdquo; синтаксис, что усложняет переезд на него (в случае необходимости)</li><li>jQuery! Напугал? Это хорошо, ибо бывают сценарии, когда он НУЖОН.</li></ul><h2 id=интересная-штучка-но-есть-ли-у-неё-практическое-применение>&ldquo;Интересная штучка, но есть-ли у неё практическое применение?&rdquo;<a href=#интересная-штучка-но-есть-ли-у-неё-практическое-применение class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Итак, мы бегло посмотрели на &ldquo;главных игроков&rdquo; QA-рынка
(в моих бредовых фантазиях. Да-да, санитары уже выехали),
но раз инструменты - есть, потребность - есть, то почему все эти
<a href=https://habr.com/ru/company/ruvds/blog/450316/>TDD</a>,
<a href=https://ru.wikipedia.org/wiki/BDD_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)>BDD</a>
и прочее еще не стали мейнстримом?</p><p>(Оффтоп: если стало - сорян, автор в танке и пошел выпить <em>йаду</em>. Дальше лучше не читать)</p><p>По моему опыту, проблема всегда плюс-минус одна: <strong>ДОРОГО</strong>.</p><h3 id=почему-дорого>Почему дорого?<a href=#почему-дорого class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Потому что бизнес не очень любит кидаться в людей деньгами (ВНЕЗАПНО!),
и для него <strong>оптимизация</strong> - слово покруче, чем <strong>библия</strong> для верующего.</p><p>(Мой агностик идет разбирацца, где это я таких слов понабрался)</p><p>Если вкратце, то на момент 2K22 разрабы - это дорого, а содержать
команду разрабов - это вообще дофига дорого.
Scrum, Agile, и вот эту вот всю &ldquo;движуху&rdquo; не от хорошей жизни придумали.</p><p>Так а все-таки, почему именно <strong>Дорого?</strong></p><p>Потому что писать тесты - долго.
Да, условный Cypress пытается решить эту проблему (в мире Frontend&rsquo;a), но все равно -
бизнес каждый раз оказывается перед выбором:</p><ul><li>Сделать новую супер-пупер-свистящую фичу?</li><li>Покрыть приложени тестами?</li></ul><p>Догадайтесь, что выбирают чаще.</p><h2 id=но-ведь-на-дистанции-все-равно-ведь-дешевле-содержать-с-тестами-разве-нет>Но ведь на дистанции все-равно ведь дешевле содержать с тестами, разве нет?<a href=#но-ведь-на-дистанции-все-равно-ведь-дешевле-содержать-с-тестами-разве-нет class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Ответ - <strong>безусловно</strong>, но:</p><ul><li>Если эти тесты писал тот, кто УМЕЕТ ПИСАТЬ ТЕСТЫ.</li><li>Если у бизнеса есть на это ДЕНЬГИ</li></ul><p>А теперь, давайте по пунктам:</p><h3 id=что-значит-уметь-писать-тесты>Что значит: уметь писать тесты?<a href=#что-значит-уметь-писать-тесты class=hanchor arialabel=Anchor>&#8983;</a></h3><ul><li>Тесты замедляют &ldquo;ржавение&rdquo; кода</li><li>Тесты тестируют то, что НАДО тестировать</li><li>Тесты частично снимают с условного Лида задачу по постоянному надзору за <code>chaotic-джунами</code></li><li>Тесты (с некоторыми ограничениями) выполняют функцию Доки по проекту (для разрабов!)</li><li>Тесты с определенным процентом успеха не пускают кривой код в production (ВНЕЗАПНО №2)</li></ul><h3 id=что-значит-у-бизнеса-есть-на-это-деньги>Что значит: у бизнеса есть на это деньги?<a href=#что-значит-у-бизнеса-есть-на-это-деньги class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Вкратце - то самое и значит.
&ldquo;Кто платит, тот и музыку заказывает&rdquo;, а если инвестор условного стартапа в душе не сечёт,
что и зачем мы там вошкаем как dev-team, то ему с высокой калокольни начхать на всё это &ldquo;ржавение кода на дистанции&rdquo;.</p><p>Для условного инвестора важно ЗАРАБОТАТЬ (ВНЕЗАПНОЕ №3)</p><p>Проблемы начинаются, когда условный стартап перестает быть просто &ldquo;очередным стартапом&rdquo;,
и начинает плавно переходить в категорию &ldquo;продуктовой компании&rdquo;.</p><p>Причина? Привычка.</p><h2 id=привычка>Привычка?<a href=#привычка class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Привычка.</p><p>Привычка просто имплементировать фичи, и закрывать 100500 тасок в секунду
(и плевать, что отвалилась регистрация - починим в моменте, раньше же так делали? Делали. Значит, и сейчас сделаем)</p><p>Привычка тестировать продукт силами самой dev-team или product-team
(в редких случаях - силами qa-team),
ведь &ldquo;вы же сами это написали, и вы говорите, что не можете предугадать, как поведет себя продукт?
Я начинаю сомневаться в вашей компетентности&rdquo; (и еще 1000 классных фраз от новоявленного CEO, CTO, whatever&mldr;)</p><h3 id=а-потом---суп-с-котом-шта>А потом - суп с котом (ШТА???)<a href=#а-потом---суп-с-котом-шта class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Ладно-ладно, хватит кидаться тапками.
Торжественно клянусь, (<em>что замышляю только шалость</em>)
что ни одна животинка в ходе написания данного поста не пострадала.
(Комары - не в счёт)</p><p>Суммарно, круг замкнулся. Приложение стало крутым? Стало.</p><p>Приложение разрослось? Разрослось.</p><p>Так а тесты-то где??? А их нету, потому что мы работаем на бизнес (пам-пам),
а бизнесу нужно закрывать отчеты, нанимать персонал, и вот это вот все.</p><h2 id=а-что-в-итоге>А что в итоге?<a href=#а-что-в-итоге class=hanchor arialabel=Anchor>&#8983;</a></h2><p>По итогу (и по опыту прошлых компаний), если не было абстрактного &ldquo;единорога&rdquo;,
который бы жестко и бескомпромиссно топил за тесты, то возможны 2 пути:</p><h3 id=андрюха-все-ня-давай-по-новой>&ldquo;Андрюха, все ***ня. Давай по-новой&rdquo;<a href=#андрюха-все-ня-давай-по-новой class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Идея следующая: условного менеджера высшего звена (тут без сарказма: крутые ребята)
настолько задолбало, что ему из каждого утюга звенят:</p><ul><li>это плохо работает</li><li>это сделать нельзя,</li><li>этот крутой разраб, для появления которого был призван сам Сатана, ушел и плакал кровавыми слезами,
как только увидел код</li></ul><p>(<strong>накидываем на вентилятор, накидываем, ну же, активнее</strong>)</p><p>Что он принимает волевое решение: отложить какое-то количество денег на глобальную перепись кода.</p><p>Сразу скажу: мне повезло, и я когда-то попал именно на такой путь именно в такой компании,
а потому четко себе представляю, что там &ldquo;за поворотом&rdquo;.</p><p>Чаще всего, данный путь выбирают, когда бизнес больше не может расти, ибо обслужиание и поддержание
кодовой базы продукта стоит дороже какого-то выставленного потолка.</p><p>Итог: пан или пропал.</p><ul><li>ИЛИ Все круто, и мы могучим рывком все сделали красиво</li><li>ИЛИ Простите, п**дец. Переписывание затянулось, бизнес теряет все больше, а конкуренты счастливы.</li></ul><p>О развязке думайте сами.</p><h3 id=мягкая-сила-в-действии>&ldquo;Мягкая сила&rdquo; в действии<a href=#мягкая-сила-в-действии class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Идея следующая: под мудрым надзором (<em>Гендальфа</em>) крутого Лида/Лидов,
начинаются точечные, но конкретные улучшения кода.</p><p>Что-то чистится, что-то выкидывается, что-то просто стабилизируется. Это нормально,
но сразу ремарка - найти лидов, которые могут это стабильно выносить и доносить до
бизнеса ценность - квест похлеще &ldquo;я найду Цири и верну ее домой&rdquo;.</p><p>Обычно, это встраивается в процессы организации, и таким нехитрым финтом
еще сильнее замедляется &ldquo;ржавение кода&rdquo;. Когда-то он все-равно произойдет,
но сейчас - мы тут ржавчину убрали, тут подкрасили, тут костылик подставили - круто,
теперь можно и фичу добавить.</p><p>Итог: эволюция/энволюция (тут как повезет).
Из практики, чаще всего начинают именно этот путь, но вот стабильно ему следуют - единицы.</p></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://oneeyed1366.github.io/blog/assets/main.js></script>
<script src=https://oneeyed1366.github.io/blog/assets/prism.js></script>
<script src=https://oneeyed1366.github.io/blog/assets/languageSelector.js></script></div></body></html>